<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é£Ÿå“ç‡Ÿé¤ŠæŸ¥è©¢ç³»çµ±</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    <style>
        body { font-family: "Microsoft JhengHei", sans-serif; background-color: #f0f2f5; padding: 20px; }
        .container { max-width: 900px; margin: 0 auto; background: white; padding: 30px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        h1 { color: #1a73e8; text-align: center; margin-bottom: 25px; }
        .search-box { position: sticky; top: 0; background: white; padding: 10px 0; z-index: 100; display: flex; gap: 10px; }
        input { flex: 1; padding: 15px; border: 2px solid #dfe1e5; border-radius: 25px; font-size: 18px; outline: none; }
        input:focus { border-color: #1a73e8; }
        button { padding: 0 25px; background: #1a73e8; color: white; border: none; border-radius: 25px; cursor: pointer; font-size: 16px; }
        #status { text-align: center; padding: 10px; color: #666; font-weight: bold; margin-bottom: 10px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th { background-color: #1a73e8; color: white; padding: 12px; position: sticky; top: 70px; }
        td { padding: 12px; border-bottom: 1px solid #eee; text-align: center; }
        tr:nth-child(even) { background-color: #f8f9fa; }
        .food-name { text-align: left; font-weight: bold; color: #333; }
        .kcal { color: #d93025; font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸ é£Ÿå“ç‡Ÿé¤ŠæŸ¥è©¢ç³»çµ±</h1>
    <div id="status">æ­£åœ¨è®€å–è³‡æ–™...</div>
    
    <div class="search-box">
        <input type="text" id="searchInput" placeholder="æœå°‹é£Ÿç‰©ï¼ˆä¾‹ï¼šé›èƒ¸è‚‰ã€å¤§éº¥ï¼‰..." disabled>
        <button onclick="doSearch()">æœå°‹</button>
    </div>

    <div style="overflow-x: auto;">
        <table id="resultTable" style="display:none;">
            <thead>
                <tr>
                    <th style="text-align:left;">æ¨£å“åç¨±</th>
                    <th>ç†±é‡(kcal)</th>
                    <th>è›‹ç™½è³ª(g)</th>
                    <th>è„‚è‚ª(g)</th>
                    <th>ç¢³æ°´(g)</th>
                    <th>éˆ‰(mg)</th>
                </tr>
            </thead>
            <tbody id="resultBody"></tbody>
        </table>
    </div>
</div>

<script>
    let db = [];

    // ç›´æ¥æŒ‡å®š CSV çš„æ¬„ä½ä½ç½®ï¼ˆæ ¹æ“šä½ ä¸Šå‚³çš„ data.csvï¼‰
    const COL_NAME = 2;   // æ¨£å“åç¨±
    const COL_KCAL = 6;   // ç†±é‡
    const COL_PRO = 9;    // è›‹ç™½è³ª
    const COL_FAT = 10;   // è„‚è‚ª
    const COL_CHO = 13;   // ç¢³æ°´
    const COL_NA = 22;    // éˆ‰

    Papa.parse("data.csv", {
        download: true,
        header: false,
        skipEmptyLines: true,
        complete: function(results) {
            const rows = results.data;
            
            // è·³éç¬¬ 0 è¡Œï¼ˆèªªæ˜ï¼‰å’Œç¬¬ 1 è¡Œï¼ˆæ¨™é¡Œï¼‰ï¼Œå¾ç¬¬ 2 è¡Œé–‹å§‹æŠ“è³‡æ–™
            if (rows.length > 2) {
                db = rows.slice(2).map(row => {
                    return {
                        name: row[COL_NAME] ? row[COL_NAME].trim() : "",
                        kcal: row[COL_KCAL] || "0",
                        pro:  row[COL_PRO] || "0",
                        fat:  row[COL_FAT] || "0",
                        cho:  row[COL_CHO] || "0",
                        na:   row[COL_NA] || "0"
                    };
                }).filter(item => item.name !== "");

                document.getElementById('status').innerText = `âœ… è¼‰å…¥æˆåŠŸï¼å…± ${db.length} ç­†é£Ÿå“è³‡æ–™ã€‚`;
                document.getElementById('status').style.color = "green";
                document.getElementById('searchInput').disabled = false;
            } else {
                document.getElementById('status').innerText = "âŒ éŒ¯èª¤ï¼šæª”æ¡ˆåˆ—æ•¸ä¸è¶³ã€‚";
            }
        },
        error: function() {
            document.getElementById('status').innerText = "âŒ éŒ¯èª¤ï¼šæ‰¾ä¸åˆ° data.csvã€‚";
            document.getElementById('status').style.color = "red";
        }
    });

    function doSearch() {
        const query = document.getElementById('searchInput').value.trim().toLowerCase();
        const table = document.getElementById('resultTable');
        const body = document.getElementById('resultBody');

        if (!query) {
            table.style.display = 'none';
            return;
        }

        // æœå°‹åŒ…å«é—œéµå­—çš„é£Ÿç‰©
        const filtered = db.filter(item => item.name.toLowerCase().includes(query)).slice(0, 50);

        if (filtered.length > 0) {
            table.style.display = 'table';
            body.innerHTML = filtered.map(item => `
                <tr>
                    <td class="food-name">${item.name}</td>
                    <td class="kcal">${item.kcal}</td>
                    <td>${item.pro}</td>
                    <td>${item.fat}</td>
                    <td>${item.cho}</td>
                    <td>${item.na}</td>
                </tr>
            `).join('');
        } else {
            table.style.display = 'none';
            alert("æ‰¾ä¸åˆ°è©²é£Ÿç‰©ï¼Œè«‹è©¦è©¦å…¶ä»–é—œéµå­—ï¼");
        }
    }

    // æ”¯æ´ Enter éµæœå°‹
    document.getElementById('searchInput').addEventListener('keypress', (e) => {
        if (e.key === 'Enter') doSearch();
    });
</script>

</body>
</html>
